\input{../tikzheader.tex}

\begin{document}
	
	
	\begin{tikzpicture}[scale=0.7,dot/.style={circle,minimum size=1mm,inner sep=0pt, fill=\cola}]

	\filldraw[fill=\colc,draw=black] plot coordinates {(-4,0.5) (-3.5,0.5) (-3.5,2) (-4,2) (-4,0.5)};	
	\draw node at (-3.75,1.25) {\Large$\tilde{\vy}$};
	
	\draw[-, line width=.2mm] (-3.75,2)--(-3.75,2.8);
	\draw[-, line width=.2mm] (-3.75,2.8)--(2.5,2.8);
	\draw[-, line width=.2mm] (2.5,2.8)--(2.5,0.5);
	\draw[->, line width=.2mm] ((2.5,0.5)--(3,0.5);

				
	\filldraw[fill=\colc,draw=black] plot coordinates {(-3.3,0.5) (-2.8,0.5) (-2.8,2) (-3.3,2) (-3.3,0.5)};	
	\draw node at (-3.1,1.2) {\Large$\vz$};

	\begin{scope}[yshift=2.5cm,rotate=180]
	\tikznn{0}{0}{fill=\cola}
	\end{scope}
	\draw node at (-1.2,1.2) {\Large$G$};
		
%	\filldraw[fill=\cold, draw=black] plot coordinates {(.4,0) (.4,2.5) (1.2,2.5) (1.2,0) (.4,0) };
	\tikzbrectshort{.4}{0.2}{fill=\cold,draw=black}
	\draw node at (.8,1.2) {\Large$\tilde{\vx}$};
	
	\tikzbrectshort{.4}{-2.3}{fill=\colc};
	\draw node at (.8,-1.4) {\Large$\vx$};
	
	
	\draw[-, line width=.2mm] (1.2,1.2)--(2.1,1.2);
	\draw[-, line width=.2mm] (2.1,1.2)--(2.1,0.2);
	\draw[->, line width=.2mm] ((2.1,0.2)--(3,0.2);
	
	\draw[-, line width=.2mm] (1.2,-1.3)--(2.1,-1.3);
	\draw[-, line width=.2mm] (2.1,-1.3)--(2.1,-0.3);
	\draw[->, line width=.2mm] ((2.1,-0.3)--(3,-0.3);
		

	\filldraw[fill=\cola,draw=black] plot coordinates {(3, 1.3) (5.5,-0.3) (5.5,-1.3) (3,-1.3) (3,1.3) };	
	\filldraw[fill=\cola,draw=black] plot coordinates {(3, 1.3) (5.5,1.3) (5.5,0.3) (3,-1.3) (3,1.3) };	
	%\tikznn{3}{-1.3}{draw=black,fill=\cola}
	\draw node at (4.8,0.8) {\Large$D$};


	\draw node at (4.8,-0.8) {\Large$C$};
	%\filldraw[fill=\cold,draw=black] plot coordinates {(5.7,-1) (5.7,0.5) (6.2,0.5) (6.2,-1) (5.7,-1) };
%	\tikzbrectsmall{5.7}{0}{fill=\colb,draw=black}

	\filldraw[fill=\colb,draw=black] plot coordinates {(5.7, 1.3) (6.2,1.3) (6.2,0.3) (5.7,0.3) (5.7,1.3) };	
		
	\draw node at (5.95,0.55) {\large$0$};
	\draw node at (5.95,1) {\large$1$};
	
	\filldraw[fill=\cold,draw=black] plot coordinates {(5.7, -0.3) (6.2,-0.3) (6.2,-1.3)  (5.7,-1.3) (5.7,-0.3) };	
	\draw node at (5.95,-0.8) {\Large$\tilde{\vy}$};

	\filldraw[fill=\colc,draw=black] plot coordinates {(-4,-3) (-3.5,-3) (-3.5,-1.5) (-4,-1.5) (-4,-3)};	
	\draw node at (-3.75,-2.45) {\Large$\vy$};	
	
	\draw node at (-3.75,1.25) {\Large$\Hat{\vy}$};
	
	\draw[-, line width=.2mm] (-3.75,0.5)--(-3.75,-0.5);
	\draw[-, line width=.2mm] (-3.75,-1.5)--(-3.75,-0.5);
	\draw[->, line width=.2mm] (-3.75,-0.5)--(-3.5,-0.5);

	\draw[-, line width=.2mm] (5.95,-1.3)--(5.95,-2.8);
	\draw[-, line width=.2mm] (5.95,-2.8)--(0,-2.8);
	\draw[-, line width=.2mm] (0,-2.8)--(0,-0.5);
	\draw[->, line width=.2mm] (0,-0.5)--(-0.4,-0.5);
	
	\filldraw[fill=\colb,draw=black] plot coordinates {(-3.5, -0.3) (-0.4,-0.3) (-0.4,-0.8) (-3.5,-0.8) (-3.5,-0.3) };	
	\draw node at (-1.95,-0.55) {{\small \textbf{cross-entropy}}};
	
	\end{tikzpicture}
	
\end{document}