\input{../tikzheader.tex}

\begin{document}
	
	
	\begin{tikzpicture}[scale=0.7,dot/.style={circle,minimum size=1mm,inner sep=0pt, fill=\cola}]
		
	\filldraw[fill=\colc, draw=black] plot coordinates {(1,0) (1,2.5) (1.8,2.5) (1.8,0) (1,0) };
	\draw node at (1.4,1.2) {\Large$\vx$};
		
	\tikznn{2}{0}{draw=black,fill=\cola}
	\draw node at (3.2,1.2) {\Large$F$};

	\filldraw[fill=\cold,draw=black] plot coordinates {(4.7,0.5) (4.7,2) (5.2,2) (5.2,0.5) (4.7,0.5) };
	
	\draw node at (4.95,0.8) {\large$\mu$};
	\draw node at (4.95,1.6) {\large$\Sigma$};
	
	\draw[->, line width=.2mm] (5.2,0.8)--(5.8,0.8);
	\filldraw[fill=white,draw=black] (6 ,0.8) circle (0.2);
	\draw node at (6,0.8) {\large$+$};

	\draw[->, line width=.2mm] (6.2,0.8)--(6.8,0.8);
	\filldraw[fill=white,draw=black] (7 ,0.8) circle (0.2);
	\node at (7,0.8) {\large$\times$};	

	\draw[->, line width=.2mm] (7.2,0.8)--(7.8,0.8);
	\filldraw[fill=\cold,draw=black] plot coordinates {(7.8,0.5) (7.8,2) (8.3,2) (8.3,0.5) (7.8,0.5)};	
	\draw node at (8.05,1.2) {\Large$\vz$};
	
	\draw[-, line width=.2mm] (5.2,1.6)--(7,1.6);
	\draw[->, line width=.2mm] (7,1.6)--(7,1);
	
	\draw[-, line width=.2mm] (5.2,0)--(6,0);
	\draw[->, line width=.2mm] (6,0)--(6,0.6);
	\filldraw[fill=\colc,draw=black]  plot coordinates {(4.75,-.25) (5.25,-0.25) (5.25,0.25) (4.75,0.25) (4.75,-.25)} ;
	\node at (4.95,0.0) {\large$\epsilon$};		
	
		
	\begin{scope}[xshift=15cm,yshift=2.5cm,rotate=180]
		\tikznn{4}{0}{fill=\cola}
	\end{scope}
	\draw node at (9.8,1.2) {\Large$G$};
	
	\filldraw[fill=\colc, draw=black] plot coordinates {(11.2,0) (11.22,2.5) (12,2.5) (12,0)(11.2,0)};
	\draw node at (11.6,1.2) {\Large$\hat{\vx}$};
	
				%L2
	
	\draw[-, line width=.2mm] (1.4,2.5)--(1.4,3.2);
	\draw[->, line width=.2mm] (1.4,3.2)--(6.3,3.2);
	
	\filldraw[fill=\colb,draw=black] plot coordinates {(6.3,2.8) (7.8,2.8) (7.8,3.6) (6.3,3.6) (6.3,2.8)};	
	\draw node at (7.1,3.2) {\Large$\ell_2$};
	
	%% yhat
	\draw[-, line width=.2mm] (11.6,2.5)--(11.6,3.2);
	\draw[->, line width=.2mm] (11.6,3.2)--(7.8,3.2);

	\draw[->, line width=.2mm] (8.05,0.5)--(8.05,0);	
	\filldraw[\colb, draw=black]  plot coordinates {(7.55, -0.8) (8.55,-0.8) (8.55, -0) (7.55, -0) (7.55,-0.8) };
	\draw node at (8.05,-0.4) {\small$D_{KL}$};
	\end{tikzpicture}
	
\end{document}